<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<title>Markdown 文档在线预览</title>

<!-- 
https://github.com/chjj/marked
-->
<script src="res/jquery-3.1.1.min.js"></script>
<link rel="stylesheet" href="res/doc.css" charset="utf-8">
<script src="res/marked.js"></script>

<!-- 
http://www.ghostchina.com/adding-syntax-highlighting-to-ghost-using-highlight-js/
-->
<link href="res/monokai_sublime.min.css" rel="stylesheet">  
<script src="res/highlight.min.js"></script> 

</head>
<body>
<div class="toolbar">
	<span class="import-md">
		导入 md 文档<input type="file" id="importMD" accept="*.md">
	</span>

	<!-- <p><a href="https://maxiang.io/">马克飞象</a></p>
	<p><a href="http://www.jianshu.com/p/9cef7044a8d2">Markdown转为 Word</a></p> -->
</div>
<div id="content" class="doc-content"></div>
<script>
(function(){
	var _file = "example/example.md";
	// var _file = "im-integration.md";
	$.get(_file, function(response, status, xhr){ 
		renderMD(response);
	});

	$("#importMD").on("change",function(e){
		var file = this.files[0];
		fileReaderText(file,function(response){
			renderMD(response);
		});
		this.value = "";
	});
})();

function fileReaderText(file,callback){
	var reader = new FileReader();
	reader.readAsText(file, "utf-8");   //UTF-16

	reader.onload = function(evt){
		callback(evt.target.result);
	}
}

function renderMD(md){
	var _html = marked(md);
	$("#content").html(_html);
	document.title = $("#content h1").html();
	$('pre > code').each(function(i, block) {
		hljs.highlightBlock(block);
	});	
}
</script>

</body>
</html>